{% extends 'common/base.html' %}

{% load static %}

{% block header_back_button %}
        <a class="navbar-brand plit-color" href="/"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
            width="30" height="30"
            viewBox="0 0 172 172"
            style=" fill:#000000;">
            <g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#57c3dd"><path d="M141.54167,154.08333h-32.25c-4.94858,0 -8.95833,-4.00975 -8.95833,-8.95833v-32.25c0,-3.95958 -3.20708,-7.16667 -7.16667,-7.16667h-14.33333c-3.95958,0 -7.16667,3.20708 -7.16667,7.16667v32.25c0,4.94858 -4.00975,8.95833 -8.95833,8.95833h-32.25c-4.94858,0 -8.95833,-4.00975 -8.95833,-8.95833v-68.39508c0,-8.23808 3.77683,-16.02108 10.24475,-21.11658l50.92633,-40.12975c1.95292,-1.53367 4.70492,-1.53367 6.65425,0l50.9335,40.12975c6.46792,5.0955 10.24117,12.87492 10.24117,21.10942v68.40225c0,4.94858 -4.00975,8.95833 -8.95833,8.95833z"></path></g></g>
        </svg>
        </a>
{% endblock %}

{% block body %}
    <div class="col-12">
        <div class="row">
            <div class="col-12 my-2" style="padding: 0 8px;">
                <div class="mrow">
                    <div class="col-12">
                        <div class="row">
                            <div class="col-12 p-3 bg-white rounded" style="box-shadow: 0px 2px 12px 0.3px #9e9e9e;">
                                <div class="mrow">
                                    <div class="col-12"><span style="font-size:27px"
                                                              class="float-left text-info">Соревнования</span></div>
                                    <hr class="bg-info" style="width: 100%;">
                                    <div class="col-12">
                                        {% for competition in competitions %}
                                            <a class="badge badge-info" href="{% url 'judge:apparatus-list' competition.id %}">
                                                {{ competition.competition.name }} <br> {{ competition.name }}
                                                <br>
                                                <small>{{ competition.date|date:'d.m H:i' }}</small>
                                            </a>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-12 p-2 text-center">
                <div class="mrow">
                    <div class="col-12 bg-white rounded p-3" style="box-shadow: 0px 2px 12px 0.3px #9e9e9e;">
                        <div class="row">
                            <div class="col-12">
                                <span style="font-size:23px" class="float-left text-info">Личная информация</span>
                            </div>
                            <div class="col-12">
                                <hr class="bg-info" style="width: 100%;">
                            </div>
                            <div class="col-12">
                                <form method="post">
                                    {% csrf_token %}
                                    <div class="mrow">
                                        <div class="col-12 my-2">
                                            <div class="row">
                                                <div class="col-4">
                                                    <label for="id_last_name">{{ user_ext_form.last_name.label }}</label>
                                                </div>
                                                <div class="col-8">
                                                    <input name="last_name"  class="form-control" id="id_last_name" value="{{ user_ext_form.last_name.value }}">
                                                </div>
                                                {% if user_ext_form.last_name.erros %}
                                                <span class="error-test">{{ user_ext_form.last_name.erros.0 }}</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                        <div class="col-12 my-2">
                                            <div class="row">
                                                <div class="col-4">
                                                    <label for="id_first_name">{{ user_ext_form.first_name.label }}</label>
                                                </div>
                                                <div class="col-8">
                                                    <input name="first_name" class="form-control" id="id_first_name" value="{{ user_ext_form.first_name.value }}">
                                                </div>
                                                {% if user_ext_form.first_name.erros %}
                                                <span class="error-test">{{ user_ext_form.first_name.erros.0 }}</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                        <div class="col-12 my-2">
                                            <div class="row">
                                                <div class="col-4">
                                                    <label for="id_middle_name">{{ user_ext_form.middle_name.label }}</label>
                                                </div>
                                                <div class="col-8">
                                                    <input name="middle_name" class="form-control" id="id_middle_name" value="{{ user_ext_form.middle_name.value }}">
                                                </div>
                                                {% if user_ext_form.middle_name.erros %}
                                                <span class="error-test">{{ user_ext_form.middle_name.erros.0 }}</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                        <div class="col-12 my-2">
                                            <div class="row">
                                                <div class="col-4">
                                                    <label for="id_position">{{ user_ext_form.position.label }}</label>
                                                </div>
                                                <div class="col-8">
                                                    <input name="position" class="form-control" id="id_position" value="{{ user_ext_form.position.value }}">
                                                </div>
                                                {% if user_ext_form.position.erros %}
                                                <span class="error-test">{{ user_ext_form.position.erros.0 }}</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row">
                                                <div class="col-md-6 col-lg-6 col-sm-12 text-center">
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <img onclick="clickPhotoInput()" id="judge_photo" style="height: 100px" src="
                                                            {% if user_ext_form.photo.value %}
                                                            {{ user_ext_form.photo.url }}
                                                            {% else %}
                                                            {% static 'common/images/unknown.png' %}
                                                            {% endif %}
                                                            ">
                                                        </div>
                                                        <div class="col-12">
                                                            <input style="display: none" name="photo" type="file">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 col-lg-6 col-sm-12 text-center" style="padding-top: 40px;">
                                                    <button class="btn btn-warning" type="submit">Сохранить</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-12 p-2">
            <div class="mrow">
                <div class="col-12 bg-light rounded p-3" style="box-shadow: 0px 2px 12px 0.3px #9e9e9e;">
                    <div class="row">
                        <div class="col-12">
                            <span style="font-size:23px" class="float-left text-info">История судейства</span>
                        </div>
                        <div class="col-12">
                            <hr class="bg-info" style="width: 100%;">
                        </div>
                        <div class="col-12">
                            <div class="row">
                                {% for judge in judge_history %}
                                    <div class="col-12 my-2" data-id="{{ judge.id }}">
                                        <div class="mrow">
                                            <div class="col-12 shadow rounded p-3">
                                                <div class="row">
                                                    <div class="col-8">
                                                        <span class="text-uppercase">{{ judge.competition.competition.competition_scope.name }}</span>
                                                        <span class="text-muted">
                                                            <small>{{ judge.competition.competition.name }}</small>
                                                        </span>
                                                    </div>
                                                    <div class="col-4 text-right"><span
                                                            class="badge badge-warning">{{ judge.competition.date|date:'d.m.Y' }}</span>
                                                    </div>
                                                    <div class="col-6 text-muted"
                                                         style="text-shadow: 0 0 2px #3d9cb3;">
                                                        <small>{{ judge.get_apparatus_display }}</small>
                                                    </div>
                                                    <div class="col-6 text-right">
                                                        комментарии:
                                                        <span class="badge">{{ judge.comments_count }}</span>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>
{% endblock %}


{% block scripts %}

<script>
function clickPhotoInput(){
    $('input[name="photo"]').click()
}
</script>
{% endblock %}